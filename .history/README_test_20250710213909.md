# DeepPGSolver Test Script

This directory contains a comprehensive test script for the DeepPGSolver, which implements deep learning solutions for multi-agent potential games.

## Files

- `test_deep_pg_solver.py`: Main test script with three different test configurations
- `requirements.txt`: Python dependencies needed to run the tests
- `DeepPGSolver.py`: The main solver implementation
- `Parameters.py`: Parameter configuration class

## Installation

1. Install the required dependencies:
```bash
pip install -r requirements.txt
```

## Usage

### Quick Test
Run the simple configuration test for quick validation:
```bash
python test_deep_pg_solver.py
```

### Individual Tests
You can also run individual test functions by modifying the `main()` function in `test_deep_pg_solver.py`:

```python
# Run only the simple test
model = test_simple_configuration()

# Run only the flocking game test
model = test_flocking_game()

# Run only the aversion game test
model = test_aversion_game()
```

## Test Configurations

### 1. Simple Configuration Test
- **Purpose**: Quick validation with minimal parameters
- **Players**: 2
- **State Dimension**: 1D
- **Game Type**: Flocking
- **Training**: 1 iteration, 5 epochs
- **Trajectories**: 50 samples, 10 time steps

### 2. Flocking Game Test
- **Purpose**: Test flocking behavior in 2D
- **Players**: 4
- **State Dimension**: 2D
- **Game Type**: Flocking
- **Training**: 3 iterations, 10 epochs
- **Trajectories**: 100 samples, 25 time steps

### 3. Aversion Game Test
- **Purpose**: Test aversion behavior in 1D
- **Players**: 4
- **State Dimension**: 1D
- **Game Type**: Aversion
- **Training**: 3 iterations, 10 epochs
- **Trajectories**: 100 samples, 25 time steps

## Output

The test script will:
1. Train neural networks for each player
2. Generate trajectory plots (saved in `output/` directory)
3. Save trained models (saved in `outputNN/` directory)
4. Display training progress and loss values

## Expected Results

- **Training Loss**: Should decrease over iterations
- **Trajectory Plots**: Should show coordinated movement patterns
- **Model Files**: Saved as `.pth` files in `outputNN/` directory
- **Plot Files**: Saved as `.png` files in `output/` directory

## Troubleshooting

### Common Issues

1. **Import Errors**: Make sure all dependencies are installed:
   ```bash
   pip install torch numpy matplotlib tqdm pandas
   ```

2. **Memory Issues**: Reduce the number of trajectories (`M`) or time steps (`N`) in the parameters

3. **CUDA Issues**: The script automatically uses CPU if CUDA is not available

4. **Multiprocessing Issues**: The script uses `spawn` method for multiprocessing, which should work on most systems

### Performance Tips

- Use GPU if available for faster training
- Reduce `M` (number of trajectories) and `N` (time steps) for quicker tests
- Reduce `iteration` and `epochs` for faster validation

## File Structure

```
Deep_PG_Wrapper/
├── test_deep_pg_solver.py    # Main test script
├── requirements.txt           # Dependencies
├── README_test.md            # This file
├── DeepPGSolver.py           # Main solver implementation
├── Parameters.py             # Parameter configuration
├── output/                   # Generated plots
└── outputNN/                 # Saved models
``` 